<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>OgreSwap</title>
    <meta
      name="viewport"
      content="width=device-width, height=device-height,
    user-scalable=no, initial-scale=1, maximum-scale=1"
    />
    <script src="https://unpkg.com/sounds-some-sounds@3.0.0/build/index.js"></script>
    <script src="https://unpkg.com/gif-capture-canvas@1.1.0/build/index.js"></script>
    <script src="https://unpkg.com/pixi.js@5.3.0/dist/pixi.min.js"></script>
    <script src="https://unpkg.com/pixi-filters@3.1.1/dist/pixi-filters.js"></script>
    <script src="https://unpkg.com/crisp-game-lib@1.1.1/docs/bundle.js"></script>

<script>
title = "Ogre Swap";

description = ` Tap to swap

protect the ogre
`;

characters = [
`
g   g
 ggg
ggggg
glglg
ggggg
 grg
`
,
`
 g
lll
lll
`
,
`
 LLL
LlLlL
 LRL 
LlLlL
`
,
`
 LLL
LlLlL
 LRL 
LlLlL
`
];

const G = {
	WIDTH: 100,
	HEIGHT: 150,
};

options = {
  viewSize: {x: G.WIDTH, y: G.HEIGHT},
  theme: "shapeDark",
  isPlayingBgm: true,
  isReplayEnabled: true,
};

let player;
let playerPos;
let enemy;
let temp;


let x = Math.random() * (G.WIDTH-3);
let y = Math.random() * (G.HEIGHT-3);
let dx = Math.random() > 0.5 ? 1 : -1; // Random initial direction for dx (1 or -1)
let dy = Math.random() > 0.5 ? 1 : -1; // Random initial direction for dy (1 or -1)


let ex = Math.random() * (G.WIDTH-3);
let ey = Math.random() * (G.HEIGHT-3);
let edx = 0.7;
let edy = 0.7;

let e2x = Math.random() * (G.WIDTH-3);
let e2y = Math.random() * (G.HEIGHT-3);
let e2dx = 0.7;
let e2dy = 0.7;

let ox = Math.random() * (G.WIDTH-3);
let oy = Math.random() * (G.HEIGHT-3);
let odx = 0.7;
let ody = 0.7;

// let dir = Math.floor(Math.random() * 2) + 1;;
// let rand;


function update() {
  if (!ticks) {
//x AXIS IS -0.1 TO 1
//Y AXIS IS  1 TO 98
    player = {
            pos: vec(G.WIDTH * 0.1, G.HEIGHT * 0.5),
            x: 0,
            y: 0,
    
    }
    playerPos = vec();

    onion = {
            pos: vec(G.WIDTH * 0.8, G.HEIGHT * 0.1)
    }
    enemy = {
            pos: vec(G.WIDTH * 0.2, G.HEIGHT * 0.1),
            x: 0,
            y: 0,
    }

    enemy2 = {
            pos: vec(G.WIDTH * 0.9, G.HEIGHT * 0.2),
    }
    temp={
            pos: vec(G.WIDTH *5, G.HEIGHT *5)
    }
    temp2={
            pos: vec(G.WIDTH *5, G.HEIGHT *5)
    }
    color("green");
        // Generate particles
        particle(
            player.pos.x, // x coordinate
            player.pos.y, // y coordinate
            4, // The number of particles
            1, // The speed of the particles
            -PI/2, // The emitting angle
            PI/4  // The emitting width
        );
    
  }
  // player.pos = vec(input.pos.x, input.pos.y);
  player.pos.clamp(0, G.WIDTH, 0, G.HEIGHT);
  color("black");
  char("a", player.pos);

  onion.pos = vec(onion.pos.x, onion.pos.y);
  onion.pos.clamp(0, G.WIDTH, 0, G.HEIGHT);
  char("b",onion.pos);

  enemy.pos.clamp(0, G.WIDTH, 0, G.HEIGHT);
  char("c",enemy.pos);

  enemy2.pos.clamp(0, G.WIDTH, 0, G.HEIGHT);
  char("d",enemy2.pos);

  if (player.pos.x + dx > G.WIDTH-3 || player.pos.x + dx < 0) {
        dx = -dx;
    }

  if (player.pos.y + dy > G.HEIGHT-3 || player.pos.y + dy < 0) {
      dy = -dy;
  }

  player.pos.x += dx;
  player.pos.y += dy;

  if (enemy.pos.x + edx > G.WIDTH-3 || enemy.pos.x + edx < 0) {
        edx = -edx;
    }

  if (enemy.pos.y + edy > G.HEIGHT-3 || enemy.pos.y + edy < 0) {
      edy = -edy;
  }

  enemy.pos.x += edx;
  enemy.pos.y += edy;

  if (enemy2.pos.x + e2dx > G.WIDTH-3 || enemy2.pos.x + e2dx < 0) {
        e2dx = -e2dx;
    }

  if (enemy2.pos.y + e2dy > G.HEIGHT-3 || enemy2.pos.y + e2dy < 0) {
      e2dy = -e2dy;
  }

  enemy2.pos.x += e2dx;
  enemy2.pos.y += e2dy;

  if (onion.pos.x + odx > G.WIDTH-3 || onion.pos.x + odx < 0) {
        odx = -odx;
  }

  if (onion.pos.y + ody > G.HEIGHT-3 ||onion.pos.y + ody < 0) {
      ody = -ody;
  }

  onion.pos.x += odx;
  onion.pos.y += ody;
  
  // enemy.pos = vec(enemy.pos.x-0.5, enemy.pos.y-0.5);
  // if ( dir === 1){
  //   rand = 1;
  // }
  // else{
  //   rand = -1;
  // }
  // if( enemy.x === 0){
  //   moveEnemyLeft();
  // }

  // if( enemy.pos.x <=1 ){
  //       enemy.x ++;
  //   }

  // if( enemy.x ===1){
  //   moveEnemyRight();
  // }

  // if( enemy.pos.x > 98){
  //   enemy.x --;
  // }

  // if( enemy.y === 0){
  //   moveEnemyUp();
  // }
  // if (enemy.pos.y >= 97 ){
  //   enemy.y --;
  // }

  // if ( enemy.y ===1){
  //   moveEnemyDown();
  // }
  // if( enemy.pos.y <= 3){
  //   enemy.y ++;
  // }



  temp.pos = vec(temp.pos.x, temp.pos.y);
  temp2.pos = vec(temp.pos.x, temp.pos.y);

  //if player touches onion, addscore
  const isEat = char("a", player.pos).isColliding.char.b;
    if (isEat) {
        addScore(5, player.pos.x, player.pos.y);
        play("powerUp");
        color("red");
        particle(player.pos);
        // Generate particles
    }
  
  //if player touches enemy game over
  const isHit = char("a", player.pos).isColliding.char.c;
    if (isHit){
      play("explosion");
      end()
    }
  const isHit2 = char("a", player.pos).isColliding.char.d;
    if (isHit2){
      play("explosion");
      end()
    } 

  //check if mouse is within 2 units of enemy
  const difference1 = Math.abs(input.pos.x - enemy.pos.x);
  const difference2 = Math.abs(input.pos.y - enemy.pos.y)
    //if mouse is clicked on enemy swap places with it
    if(input.isJustPressed && (difference1 <=4 )&& difference2 <=4){
      color("yellow");
      particle(player.pos);
      temp.pos = player.pos;
      player.pos = temp2.pos;
      temp2.pos = enemy.pos;
      enemy.pos = temp.pos;
      player.pos = temp2.pos;
      //temp to hold positions
      play("laser");
      color("yellow");
    }

  const difference5 = Math.abs(input.pos.x - enemy2.pos.x);
  const difference6 = Math.abs(input.pos.y - enemy2.pos.y)
    //if mouse is clicked on enemy swap places with it
    if(input.isJustPressed && (difference5 <=4 )&& difference6 <=4){
      color("yellow");
      particle(player.pos);
      temp.pos = player.pos;
      player.pos = temp2.pos;
      temp2.pos = enemy2.pos;
      enemy2.pos = temp.pos;
      player.pos = temp2.pos;
      //temp to hold positions
      play("laser");
    }

    //check if mouse is within 2 units of onion
  const difference3 = Math.abs(input.pos.x - onion.pos.x);
  const difference4 = Math.abs(input.pos.y - onion.pos.y)
    //if mouse is clicked on onion swap places with it
    if(input.isJustPressed && (difference3 <=3 )&& difference4 <=3){    
      color("yellow");
      particle(player.pos);  
      temp.pos = player.pos;
      player.pos = temp2.pos;
      temp2.pos = onion.pos
      onion.pos = temp.pos;
      player.pos = temp2.pos;
      //temp to hold positions
      play("laser");
    }

    // function moveEnemyLeft(){
    //   enemy.pos = vec(enemy.pos.x-0.5, enemy.pos.y);
    // }

    // function moveEnemyRight(){
    //   enemy.pos = vec(enemy.pos.x+0.5, enemy.pos.y);
    // }
    // function moveEnemyUp(){
    //   enemy.pos = vec(enemy.pos.x,enemy.pos.y-0.5);
    // }
    // function moveEnemyDown(){
    //   enemy.pos = vec(enemy.pos.x,enemy.pos.y+0.5);
    // }

  
    
}

addEventListener("load", onLoad);
</script>

  </head>
  <body style="background: #eb5757"></body>
</html>